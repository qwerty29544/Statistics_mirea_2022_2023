---
title: "Практическая работа №5. Линейная регрессия. Оценка адекватности модели, оценка доверительных интервалов параметров."
author: "Юрченков Иван Александрович, ассистент кафедры ПМ"
date: "`r Sys.Date()`"
mainfont: SourceSansPro
output:
  pdf_document: 
    latex_engine: lualatex
    keep_tex: yes
    highlight: haddock
    fig_width: 8
    fig_height: 7
    fig_caption: yes
---

```{r, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, dev="cairo_pdf", dpi = 500, out.width="60%", fig.align='center')
library(dplyr)
library(stringr)
```

# **Постановка задачи для выполнения практической работы**

Для выполнения практического задания необходимо:

1.  Открыть папку, соотвествующую своей группе.

2.  Открыть папку с вариантом, совпадающим с вашим номером в списке.

В папке 3 файла с данными.

1.  1-ый файл содержит 2 ряда данных. Первый стоблец \$ x\$ содержит факторную переменную, второй столбец \$ y\$ результирующую. Для первого файла необходимо:

-   Оценить коэффициент корреляции Пирсона \$ r(x, y)\$ между двумя переменными в первом и втором столбце.

-   По шкале Чеддока оценить хакактеристику корреляционной связи между величинами.

-   Проверить статистическую значимость коэффициента корреляции Пирсона с помощью $t$-статистики.

-   Построить доверительный интервал для \$ r(x, y)\$ с надежностью $\ \gamma\ = \ 0.95$.

-   Построить линейную регрессию между столбцами, оценить значение коэффициентов линейной зависимости.

-   Оценить значимость полученных коэффициентов прямой.

-   Построить доверительные интервалы для полученных коэффициентов.

-   Оценить адекватность модели *по коэффициенту детерминации*.

-   Оценить интервал прогноза для линейной модели на \$ ft = 3\$ значения вперед.

2.  2-ой файл содержит 4 ряда данных. Первый ряд (столбец) содержит количественную факторную переменную, следующие два - качественную факторную переменную, последний - результирующую переменную. Для второго файла данных необходимо:

-   Необходимо с помощью теста Чоу обосновать необходимость деления выборки по одной из качественных факторных переменных.

-   Произвести разбиение и построить две линейных регрессии, оценить коэффициенты моделей.

3.  3-ий файл содержит 2 ряда данных. Для третьего файла данных необходимо:

-   Необходимо двумя способами (тест Спирмена и тест Гольдфельда-Квандта) определить, присутствует ли в данных гетероскедастичность.

-   Построить линейную регрессию, оценить значения коэффициентов модели.

-   Оценить значимость полученных коэффициентов и адекватность модели.

-   Все расчеты проводить для уровня значимости $\alpha = 0.05$.

# **Пример проведения регрессионного анализа для ряда данных**

## **Исследуемый ряд данных**

Рассмотрим таблицу переменных парных данных $(x, y)$ одинаковой длины без пропущенных значений для данных о цене алмазов (diamonds) с категориальными параметрами: $cut = Ideal$ (огранка), $color = J$ (цвет), $clarity = SI2$ (чистота).

```{r, echo=F}
data <- subset(ggplot2::diamonds, cut == "Ideal" & color == "J" & clarity == "SI2")
data$carat <- round(log(data$carat), 3)
data$price <- round(log(data$price), 3)
data <- data[, c("carat", "price")]
colnames(data) <- c("ln_carat", "ln_price")
print("x")
cat(paste(1:110, data$ln_carat, "\n"))
print("y")
cat(paste(1:110, data$ln_price, "\n"))
```

| n   | x     | y    | n  | x     | y    | n  | x     | y    | n  | x     | y    |
|----|--------|------|----|-------|------|----|-------|------|----|-------|------|
|1   | -1.171 | 5.841|31  | 0.095 | 8.439|61  | 0.571 | 8.958|91  |-1.109 | 5.903|
|2   | 0.020  |      |32  | 0.231 |     |62  | 0.531 |     |92  |-0.892 |     |
|3   | 0.000  |      |33  | 0.182 |     |63  | 0.698 |     |93  |-0.942 |     |
|4   | 0.000  |      |34  | 0.215 |     |64  | 0.723 |     |94  |     |     |
|5   | 0.077  |      |35  | 0.199 |     |65  | 0.703 |     |95  |     |     |
|6   | 0.049  |      |36  | 0.239 |     |66  | 0.723 |     |96  |     |     |
|7   | 0.010  |      |37  | 0.231 |     |67  | 0.708 |     |97  |     |     |
|8   | 0.039  |      |38  | 0.182 |     |68  | 0.732 |     |98  |     |     |
|9   | 0.010  |      |39  | 0.182 |     |69  | 0.698 |     |99  |     |     |
|10  | 0.058  |      |40  | 0.239 |     |70  | 0.718 |     |100 |     |     |
|11  | 0.010  |      |41  | 0.215 |     |71  | 0.708 |     |101 |     |     |
|12  | 0.010  |      |42  | 0.231 |     |72  | 0.703 |     |102 |     |     |
|13  | 0.030  |      |43  | 0.239 |     |73  | 0.728 |     |103 |     |     |
|14  | 0.030  |      |44  | 0.239 |     |74  | 0.698 |     |104 |     |     |
|15  | 0.104  |      |45  | 0.086 |     |75  | 0.829 |     |105 |     |     |
|16  | 0.104  |      |46  | 0.207 |     |76  | 0.698 |     |106 |     |     |
|17  | 0.010  |      |47  | 0.207 |     |77  | 0.798 |     |107 |     |     |
|18  | 0.104  |      |48  | 0.293 |     |78  | 0.829 |     |108 |     |     |
|19  | 0.049  |      |49  | 0.293 |     |79  | 0.829 |     |109 |     |     |
|20  | 0.095  |      |50  | 0.322 |     |80  | 0.916 |     |110 |     |     |
|21  | 0.010  |      |51  | 0.445 |     |81  | 0.916 |     |    |     |     |
|22  | 0.131  |      |52  | 0.322 |     |82  | 0.904 |     |    |     |     |
|23  | 0.095  |      |53  | 0.419 |     |83  | 0.916 |     |    |     |     |
|24  | 0.113  |      |54  | 0.315 |     |84  | 0.928 |     |    |     |     |
|25  | 0.030  |      |55  | 0.507 |     |85  | 1.102 |     |    |     |     |
|26  | 0.049  |      |56  | 0.438 |     |86  | 0.900 |     |    |     |     |
|27  | 0.122  |      |57  | 0.438 |     |87  | 0.967 |     |    |     |     |
|28  | 0.174  |      |58  | 0.464 |     |88  | 0.959 |     |    |     |     |
|29  | 0.182  |      |59  | 0.531 |     |89  | 1.001 |     |    |     |     |
|30  | 0.182  |      |60  | 0.536 |     |90  | 0.956 |     |    |     |     |

: Таблица данных

В рассматриваемой таблице данных присутствует $n = 110$ наблюдений для каждой из рассматриваемых переменных.

При условии нормальности данных наши описательные статистики для каждой переменной выглядят следующим образом:



$$
\overline{x} = \frac{1}{n} \sum \limits_{i=1}^{n} x_i = 
$$

## **Корреляционный анализ числовых данных**

## **Тест гетероскедастичности для ряда данных**

## **Построение линейной модели регрессии**

## **Оценка статистической значимости коэффициентов линейной модели регрессии**

## **Оценка адекватности линейной модели регрессии**

## **Оценка прогнозного интервала для линейной модели регрессии**

# **Темы вопросов на защиту практической работы**

1.  Задачи корреляционного анализа. Выборочный коэффициент линейной корреляции (Пирсона) и его свойства. Шкала Чеддока.
2.  Выборочный коэффициент линейной корреляции (Пирсона) и его свойства. Оценка значимости коэффициента корреляции.
3.  Корреляция и причинная связь. Проблемы корреляционного анализа.
4.  Ранговая корреляция. Коэффициент ранговой корреляции Спирмена.
5.  Задачи регрессионного анализа. Функциональная и статистическая связь. Аппроксимационные модели. Параметрическое множество функций.
6.  Линейная регрессия. Определение коэффициентов линейной модели методом наименьших квадратов.
7.  Проверка значимости полученных коэффициентов модели. Проверка адекватности модели с помощью критерия Фишера.
8.  Доверительный интервал прогноза. Проверка адекватности модели с помощью критерия Фишера.
